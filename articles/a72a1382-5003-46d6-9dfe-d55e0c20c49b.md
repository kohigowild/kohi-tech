---
title: 03. êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ ì¶”ì  ì½”ë“œ (gtag) ì‹¬ê¸°
category: Notion APIë¡œ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°
created_time: 2024-07-14
---

## êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤(Google Analytics)


êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤(Google Analytics)ëŠ” ì›¹ì‚¬ì´íŠ¸ë‚˜ ì•±ì˜ ë°©ë¬¸ì ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ë¶„ì„í•˜ëŠ” ë„êµ¬ë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì´ ìˆë‹¤.

- ë°©ë¬¸ì ì¶”ì : ì›¹ì‚¬ì´íŠ¸ì— ëª‡ ëª…ì´ ë°©ë¬¸í–ˆëŠ”ì§€, ì–´ë””ì„œ ì™”ëŠ”ì§€, ì–´ë–¤ í˜ì´ì§€ë¥¼ ê°€ì¥ ë§ì´ ë³´ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ì í–‰ë™ ë¶„ì„: ë°©ë¬¸ìê°€ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì–´ë–¤ í–‰ë™ì„ í•˜ëŠ”ì§€, ì˜ˆë¥¼ ë“¤ì–´, ì–´ë–¤ ë²„íŠ¼ì„ í´ë¦­í•˜ëŠ”ì§€, ì–¼ë§ˆë‚˜ ì˜¤ë˜ ë¨¸ë¬´ëŠ”ì§€ ë“±ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
- ë§ˆì¼€íŒ… íš¨ê³¼ ì¸¡ì •: ê´‘ê³  ìº í˜ì¸ì´ ì–¼ë§ˆë‚˜ íš¨ê³¼ì ì¸ì§€, ì–´ë–¤ ì±„ë„(ì˜ˆ: ì†Œì…œ ë¯¸ë””ì–´, ê²€ìƒ‰ ì—”ì§„)ì„ í†µí•´ ë°©ë¬¸ìê°€ ìœ ì…ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- ì›¹ì‚¬ì´íŠ¸ ê°œì„ : ë°©ë¬¸ì ë°ì´í„°ë¥¼ ë¶„ì„í•´ ì–´ë–¤ ë¶€ë¶„ì„ ê°œì„ í•´ì•¼ í• ì§€ ì•Œ ìˆ˜ ìˆë‹¤.

ì¦‰, êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ì‚¬ì´íŠ¸ì˜ ì„±ê³¼ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ë¶„ì„í•˜ê³ , ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë” ë‚˜ì€ ì˜ì‚¬ ê²°ì •ì„ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.


## g-tag ë°œê¸‰


![Image](https://boiling-politician-9bc.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F420927ef-2057-4e77-b9b7-d7005a1db0dd%2F0a360760-0f30-4039-8310-b4ca90cce47b%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-07-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.23.11.png?table=block&id=8c43bc46-bb0c-4755-b0cb-7b6b6a58055a&cache=v2)


êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ì— ëŒ€ìƒ ì‚¬ì´íŠ¸ë¥¼ ë“±ë¡í•˜ë©´ G- ë¡œ ì‹œì‘í•˜ëŠ” IDê°€ ë°œê¸‰ë˜ëŠ”ë°, í•´ë‹¹ IDë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •í•œë‹¤.


## @types/gtag.js ì„¤ì¹˜


```javascript
npm i @types/gtag.js
```


TypeScriptì—ì„œ Google Analyticsì˜ gtag.js ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ íƒ€ì… ì •ì˜ íŒŒì¼ì´ë‹¤.


## ì¶”ì  ì½”ë“œ ì„¸íŒ…


```javascript
// êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ ì¶”ì  IDë¥¼ ë‹´ê³  ìˆëŠ” í™˜ê²½ ë³€ìˆ˜
export const TRACKING_ID = process.env.NEXT_PUBLIC_GA_TRACKING_ID

export const pageview = (url: string) => {
  if (typeof window.gtag == 'undefined') return

  window.gtag('config', TRACKING_ID as string, {
    page_path: url,
  })
}

interface GTagEventProps {
  action: string
  category: string
  label: string
  value: number
}

export const event = ({ action, category, label, value }: GTagEventProps) => {
  window.gtag('event', action, {
    event_category: category,
    event_label: label,
    value,
  })
}

```

- pageview í•¨ìˆ˜ëŠ” í˜ì´ì§€ ë·°ë¥¼ êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ì— ê¸°ë¡í•œë‹¤. window.gtagê°€ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì •ì˜ë˜ì–´ ìˆìœ¼ë©´ gtag í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ í˜ì´ì§€ ë·°ë¥¼ ì„¤ì •í•œë‹¤.
- event í•¨ìˆ˜ëŠ” íŠ¹ì • ì´ë²¤íŠ¸ë¥¼ êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ì— ê¸°ë¡í•œë‹¤. window.gtag í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì´ë²¤íŠ¸ë¥¼ ì „ì†¡í•œë‹¤.

```javascript
'use client'

import { usePathname, useSearchParams } from 'next/navigation'
import { useEffect } from 'react'
import * as gtag from '@/lib/gtag'

const AnalyticsProvider = ({ children }: { children: React.ReactNode }) => {
  const pathname = usePathname()
  const searchParams = useSearchParams()

  useEffect(() => {
    const url = pathname + searchParams.toString()
    gtag.pageview(url)
  }, [pathname, searchParams])

  return <>{children}</>
}

export default AnalyticsProvider

```

- ìœ„ì—ì„œ ì‘ì„±í•œ gtag.ts ì½”ë“œë¥¼ í† ëŒ€ë¡œ Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê²½ë¡œì™€ ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ì— í˜ì´ì§€ ë·°ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆë„ë¡ pageview í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

```javascript
export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode
}>) {
  return (
    <html lang='ko'>
      <RecoilProvider>
        <QueryProvider>
          <Suspense>
            <Script
              strategy='afterInteractive'
              src={`https://www.googletagmanager.com/gtag/js?id=${process.env.NEXT_PUBLIC_GA_TRACKING_ID}`}
            />
            <Script
              id='gtag-init'
              strategy='afterInteractive'
              dangerouslySetInnerHTML={{
                __html: `
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', '${process.env.NEXT_PUBLIC_GA_TRACKING_ID}', {
                page_path: window.location.pathname,
              });
            `,
              }}
            />
            <AnalyticsProvider>
            .
            .
            .
            </AnalyticsProvider>
          </Suspense>
        </QueryProvider>
      </RecoilProvider>
    </html>
  )
}

```

- Script ì½”ë“œëŠ” í˜ì´ì§€ê°€ ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•´ì§„ í›„ êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¡œë“œí•˜ê³  ì´ˆê¸°í™”í•œë‹¤.

![Image](https://boiling-politician-9bc.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F420927ef-2057-4e77-b9b7-d7005a1db0dd%2F6afba0b6-6667-4fae-b9ab-c2bba3566e9d%2FUntitled.png?table=block&id=e2490da8-18f4-4b7c-a4a1-be42706d6dba&cache=v2)


ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹ì´ ê°€ëŠ¥í•´ì§„ ë‚˜ì˜ ë¸”ë¡œê·¸ ğŸ« 


## Reference


[https://velog.io/@qkralsgud1324/Next.js-TS-í”„ë¡œì íŠ¸ì—-Google-Analytics-ì´ì‹í•˜ê¸°](https://velog.io/@qkralsgud1324/Next.js-TS-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90-Google-Analytics-%EC%9D%B4%EC%8B%9D%ED%95%98%EA%B8%B0)

